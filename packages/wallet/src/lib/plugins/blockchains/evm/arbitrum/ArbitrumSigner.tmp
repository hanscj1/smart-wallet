/* eslint-disable @typescript-eslint/no-unused-vars */
// ArbitrumSigner.ts
import { ethers } from 'ethers';
import type { Transaction, TypedDataDomain, TypedDataField } from '$lib/common';
import { Signer } from '$plugins/Signer';
import type { TransactionRequest } from 'alchemy-sdk';

export class ArbitrumSigner extends Signer {
  signTypedData( domain: TypedDataDomain, types: Record<string, TypedDataField[]>, value: Record<string, any> ): Promise<string> {
    throw new Error( 'Method not implemented.' );
  }
  private wallet: ethers.Wallet;

  constructor(privateKey: string | null) {
    super();
    if (!privateKey) {
      throw new Error('Private key not provided to signer');
    }
    this.wallet = new ethers.Wallet(privateKey as string);
  }

  async signTransaction(transaction: TransactionRequest): Promise<string> {
    return await this.wallet.signTransaction(transaction);
  }

  async signMessage(message: string): Promise<string> {
    return await this.wallet.signMessage(message);
  }

  async verifySigner(signerAddress: string, messageToVerify: string, signature: string): Promise<boolean> {
    try {
      const value = ethers.recoverAddress(ethers.hashMessage(messageToVerify), signature) === signerAddress;
      if (value) {
        return Promise.resolve(value);      
      } else {
        return Promise.reject(value);
      }
    } catch (e) {
      console.log(e);
      return Promise.reject(e);
    }
  }
  
}
